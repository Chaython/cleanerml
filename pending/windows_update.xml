<?xml version="1.0" encoding="UTF-8"?>
<!--

    BleachBit
    Copyright (C) 2008-2019 Andrew Ziem
    https://www.bleachbit.org

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program. If not, see <http://www.gnu.org/licenses/>.

	Rules in CleanerML written by https://github.com/Tobias-B-Besemer
	v0.7.5 done on 2019-02-26

-->
<cleaner id="windows_update" os="windows">
  <label>Windows Update</label>
  <description>Windows Update</description>
  <option id="logs">
    <label>Logs</label>
    <description>Delete Logs</description>
    <action command="delete" search="walk.all" path="%WinDir%\Logs\waasmedic"/>
    <action command="delete" search="walk.all" path="%WinDir%\Logs\WindowsUpdate"/>
    <action command="delete" search="walk.all" path="%WinDir%\SoftwareDistribution\DataStore\Logs"/>
    <action command="delete" search="walk.all" path="%WinDir%\SoftwareDistribution\DataStore.bak\Logs"/>
    <action command="delete" search="file" path="%WinDir%\SoftwareDistribution\ReportingEvents.log"/>
    <action command="delete" search="file" path="%WinDir%\WindowsUpdate.log"/>
    <action command="delete" search="file" path="%WinDir%\svcpack.log"/>
  </option>
  <option id="temp">
    <label>Temp Files</label>
    <description>Delete Temp Files</description>
    <action command="delete" search="walk.all" path="%SystemDrive%\$WINDOWS.~BT"/>
    <action command="delete" search="glob" path="%SystemDrive%\$WINDOWS.~BT"/>
    <action command="delete" search="walk.all" path="%SystemDrive%\$Windows.~WS"/>
    <action command="delete" search="glob" path="%SystemDrive%\$Windows.~WS"/>
    <action command="delete" search="glob" path="%LocalAppData%\Temp\KB*"/>
    <action command="delete" search="walk.all" path="%LocalAppData%\Temp\WUDiagTempFolder"/>
    <action command="delete" search="glob" path="%LocalAppData%\Temp\WUDiagTempFolder"/>
    <action command="delete" search="glob" path="%LocalAppData%\Temp\WindowsUpdate*"/>
  </option>
  <option id="windows_update_files">
    <label>Windows Update Files and Database</label>
    <description>Delete the Windows Update Files and the Database</description>
    <warning>Use the option only if you know what you do!</warning>
    <action command="process" cmd="net stop wuauserv"/>
    <action command="delete" search="walk.all" path="%WinDir%\SoftwareDistribution\"/>
    <action command="process" cmd="net start wuauserv"/>
  </option>
  <option id="windows_sp_backup_files">
    <label>Windows Service Pack Backup Files</label>
    <description>Deletes the Windows Service Pack Backup Files (Windows 7 and higher)</description>
    <warning>This may take a long time! (How long depends on your computer, but at least several minutes!) The program may seem to hang, but be patience, just wait! Attention: After use this option, you can't uninstall your Service Pack anymore! Use this option only if you know what you do!</warning>
    <action command="process" wait="true" cmd="dism.exe /Online /Cleanup-Image /SPSuperseded /hideSP"/>
  </option>
  <option id="winsxs_backup_files">
    <label>WinSxS Backup Files</label>
    <description>Deletes the WinSxS Backup Files</description>
    <warning>Use one your own risk! Use this option only if you know what you do!</warning>
    <action command="delete" search="walk.files" path="%WinDir%\WinSxS\Backup\"/>
  </option>
  <option id="winsxs_component_cleanup">
    <label>WinSxS Component Cleanup</label>
    <description>Makes a WinSxS Component Cleanup (Windows 8 and higher)</description>
    <warning>All existing service packs and updates cannot be uninstalled after this command is completed. But this will not block the uninstallation of future service packs or updates. Use this option only if you know what you do!</warning>
    <action command="process" wait="true" cmd="dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase"/>
  </option>
</cleaner>
